<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="B4N1: Luxury, optimized HTML page with signup/signin, contact, settings, AI chat, and calm music">
    <meta name="keywords" content="B4N1, signup, signin, luxury, optimized, HTML, contact, settings, dancing emoji, calm music, AI chat">
    <meta name="author" content="Your Name">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="B4N1 Luxury Portal">
    <meta property="og:description" content="A fast, elegant, single-file HTML with auth, contact, settings, dancing emoji, calm music, and AI chat">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-site.com">
    <title>B4N1 Luxury Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lora&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Cinzel', 'Georgia', serif;
            line-height: 1.6;
            color: #f1e4c3;
            background: linear-gradient(135deg, #0a0a23, #1c2526);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            overflow-y: auto;
            font-size: 16px;
            transition: background 0.5s ease, color 0.5s ease, font-size 0.3s ease;
            position: relative;
        }
        body.light {
            background: linear-gradient(135deg, #f1e4c3, #e6d9a2);
            color: #0a0a23;
        }

        /* Loader */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 35, 0.98);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 20;
            animation: fadeOut 1s ease 2s forwards;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #d4af37;
            border-top: 5px solid transparent;
            border-radius: 50%;
            animation: spin 1.2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes fadeOut {
            to { opacity: 0; visibility: hidden; }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Auth Gate */
        #authGate {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 35, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            overflow-y: auto;
        }
        .auth-box {
            background: #1c2526;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
            width: 100%;
            max-width: 400px;
            text-align: center;
            border: 1px solid #d4af37;
            animation: fadeIn 1s ease-in;
            margin: 1rem;
        }
        .auth-box.light {
            background: #e6d9a2;
            color: #0a0a23;
        }
        .auth-box::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, #d4af37, #f1e4c3, #d4af37);
            z-index: -1;
            opacity: 0.2;
            border-radius: 12px;
        }
        .auth-box h2 {
            color: #d4af37;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 2px 8px rgba(212, 175, 55, 0.5);
        }
        .auth-box.light h2 {
            color: #0a0a23;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        .auth-box input, .auth-box select {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #d4af37;
            border-radius: 6px;
            background: #0a0a23;
            color: #f1e4c3;
            font-family: 'Lora', serif;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .auth-box.light input, .auth-box.light select {
            background: #f1e4c3;
            color: #0a0a23;
        }
        .auth-box input:focus, .auth-box select:focus {
            outline: none;
            border-color: #f1e4c3;
            box-shadow: 0 0 8px rgba(212, 175, 55, 0.5);
        }
        .auth-box button {
            background: #d4af37;
            color: #0a0a23;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            width: 100%; /* Fixed: Added unit */
        }
        .auth-box button:hover {
            background: #b89b2f;
            transform: scale(1.02);
            box-shadow: 0 0 12px rgba(212, 175, 55, 0.6);
        }
        .toggle-btn {
            background: none;
            border: none;
            color: #f1e4c3;
            cursor: pointer;
            margin-top: 1.5rem;
            font-size: 0.9rem;
            font-family: 'Lora', serif;
            transition: color 0.3s ease;
        }
        .auth-box.light .toggle-btn {
            color: #0a0a23;
        }
        .toggle-btn:hover {
            color: #d4af37;
        }
        .auth-box.light .toggle-btn:hover {
            color: #b89b2f;
        }
        .error, .success {
            margin-top: 10px;
            display: none;
            font-family: 'Lora', serif;
            font-size: 0.9rem;
        }
        .error {
            color: #ff9999;
        }
        .success {
            color: #d4af37;
        }
        .auth-box.light .success {
            color: #b89b2f;
        }
        .password-strength.weak {
            color: #ff9999;
        }
        .password-strength.medium {
            color: #f1e4c3;
        }
        .password-strength.strong {
            color: #d4af37;
        }
        .confirm-password {
            display: none;
        }
        .signup-mode .confirm-password {
            display: block;
        }

        /* Header */
        header {
            background: transparent;
            border-bottom: 1px solid #d4af37;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            max-width: 1200px;
            margin: 20px auto 0;
            padding: 20px;
            width: 100%;
            z-index: 5;
        }
        header.light {
            background: transparent;
            border-bottom: 1px solid #b89b2f;
        }
        h1, h2 {
            color: #d4af37;
            text-shadow: 0 2px 6px rgba(212, 175, 55, 0.5);
            text-transform: uppercase;
            letter-spacing: 2px;
            text-align: center;
        }
        .light h1, .light h2 {
            color: #0a0a23;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }
        h1 {
            font-size: 2.5rem;
        }
        nav {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        nav a {
            color: #f1e4c3;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease, transform 0.2s ease;
            padding: 8px 12px;
        }
        .light nav a {
            color: #0a0a23;
        }
        nav a:hover {
            color: #d4af37;
            transform: scale(1.05);
        }
        .light nav a:hover {
            color: #b89b2f;
        }
        nav a.active {
            color: #d4af37;
            border-bottom: 1px solid #d4af37;
        }
        .light nav a.active {
            color: #b89b2f;
            border-bottom: 1px solid #b89b2f;
        }

        /* Main Content */
        main {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }
        section {
            display: none;
            animation: fadeIn 1s ease-in;
            width: 100%;
            max-width: 800px;
            text-align: center;
            margin-bottom: 20px;
        }
        section.active {
            display: block;
        }
        img, .dancing-emoji {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: block;
            margin: 1rem auto;
        }
        .light img, .light .dancing-emoji {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .dancing-emoji {
            width: 150px;
            height: 150px;
            animation: dance 1.5s ease-in-out infinite;
        }
        @keyframes dance {
            0% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-8px) rotate(4deg); }
            50% { transform: translateY(0) rotate(0deg); }
            75% { transform: translateY(-8px) rotate(-4deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        img:hover, .dancing-emoji:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6);
        }
        .light img:hover, .light .dancing-emoji:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        /* Forms */
        .content-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #d4af37;
            border-radius: 6px;
            background: #0a0a23;
        }
        .light .content-form {
            background: #f1e4c3;
            border: 1px solid #b89b2f;
        }
        .content-form input, .content-form textarea {
            padding: 12px;
            border: 1px solid #d4af37;
            border-radius: 6px;
            background: #0a0a23;
            color: #f1e4c3;
            font-family: 'Lora', serif;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .light .content-form input, .light .content-form textarea {
            background: #f1e4c3;
            color: #0a0a23;
            border: 1px solid #b89b2f;
        }
        .content-form input:focus, .content-form textarea:focus {
            outline: none;
            border-color: #f1e4c3;
            box-shadow: 0 0 8px rgba(212, 175, 55, 0.5);
        }
        .content-form button {
            background: #d4af37;
            color: #0a0a23;
            border: none;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            width: 100%;
        }
        .content-form button:hover {
            background: #b89b2f;
            transform: scale(1.02);
            box-shadow: 0 0 12px rgba(212, 175, 55, 0.6);
        }
        .content-form button:disabled {
            background: #6b5b1a;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .message {
            color: #d4af37;
            display: none;
            font-family: 'Lora', serif;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        .light .message {
            color: #b89b2f;
        }

        /* AI Chat Section */
        #ask-ai .chat-container {
            background: #1c2526;
            border: 1px solid #d4af37;
            border-radius: 8px;
            padding: 15px;
            max-height: 500px;
            overflow-y: auto;
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .light #ask-ai .chat-container {
            background: #e6d9a2;
            border: 1px solid #b89b2f;
        }
        .chat-message {
            padding: 10px;
            border-radius: 6px;
            font-family: 'Lora', serif;
            font-size: 0.9rem;
            max-width: 80%;
            word-wrap: break-word;
        }
        .user-message {
            background: #d4af37;
            color: #0a0a23;
            align-self: flex-end;
        }
        .ai-message {
            background: #0a0a23;
            color: #f1e4c3;
            border: 1px solid #d4af37;
            align-self: flex-start;
        }
        .light .user-message {
            background: #b89b2f;
            color: #0a0a23;
        }
        .light .ai-message {
            background: #f1e4c3;
            color: #0a0a23;
            border: 1px solid #b89b2f;
        }
        .chat-input {
            display: flex;
            gap: 10px;
            max-width: 600px;
            margin: 0 auto;
        }
        .chat-input input {
            flex: 1;
            padding: 12px;
            border: 1px solid #d4af37;
            border-radius: 6px;
            background: #0a0a23;
            color: #f1e4c3;
            font-family: 'Lora', serif;
        }
        .light .chat-input input {
            background: #f1e4c3;
            color: #0a0a23;
            border: 1px solid #b89b2f;
        }
        .chat-input input:focus {
            outline: none;
            border-color: #f1e4c3;
            box-shadow: 0 0 8px rgba(212, 175, 55, 0.5);
        }
        .chat-input button, .chat-controls button {
            background: #d4af37;
            color: #0a0a23;
            border: none;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Lora', serif;
            text-transform: uppercase;
            transition: background 0.3s ease, transform 0.2s ease;
        }
        .chat-controls {
            display: flex;
            justify-content: center;
            margin: 10px 0;
        }
        .chat-input button:hover, .chat-controls button:hover {
            background: #b89b2f;
            transform: scale(1.02);
        }
        .chat-input button:disabled, .chat-controls button:disabled {
            background: #6b5b1a;
            cursor: not-allowed;
            transform: none;
        }
        .chat-error {
            color: #ff9999;
            font-family: 'Lora', serif;
            font-size: 0.9rem;
            text-align: center;
            display: none;
            margin-top: 10px;
        }
        .chat-toggle {
            display: none;
            background: #d4af37;
            color: #0a0a23;
            border: none;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Lora', serif;
            text-transform: uppercase;
            margin: 10px auto;
            max-width: 200px;
            text-align: center;
        }
        .light .chat-toggle {
            background: #b89b2f;
        }
        .chat-toggle:hover {
            background: #b89b2f;
            transform: scale(1.02);
        }
        .chat-content {
            transition: max-height 0.3s ease, opacity 0.3s ease;
        }
        .chat-content.collapsed {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }

        /* Settings Panel */
        .settings-panel {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 600px;
            width: 100%;
            padding: 15px;
            margin: 0 auto;
            background: #1c2526;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            border: 1px solid #d4af37;
        }
        .light .settings-panel {
            background: #e6d9a2;
            border: 1px solid #b89b2f;
        }
        .settings-panel button, .settings-panel select {
            background: #d4af37;
            color: #0a0a23;
            border: none;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Lora', serif;
            transition: background 0.3s ease, transform 0.1s;
            width: 100%;
        }
        .settings-panel button:hover, .settings-panel select:hover {
            background: #b89b2f;
            transform: scale(1.01);
        }

        /* Footer */
        .social-links {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 10px;
        }
        .social-links a {
            color: #f1e4c3;
            font-size: 1.1rem;
            transition: color 0.3s ease, transform 0.2s ease;
        }
        .light .social-links a {
            color: #0a0a23;
        }
        .social-links a:hover {
            color: #d4af37;
            transform: scale(1.1);
        }
        .light .social-links a:hover {
            color: #b89b2f;
        }
        .remember-me {
            display: flex;
            align-items: center;
            gap: 6px;
            margin: 10px 0;
            font-family: 'Lora', serif;
            justify-content: center;
        }
        footer {
            text-align: center;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto 20px;
            width: 100%;
        }

        /* Media Queries */
        @media (max-width: 600px) {
            .chat-toggle {
                display: block;
            }
            .chat-content {
                max-height: 400px;
            }
            .chat-content.collapsed {
                max-height: 0;
            }
            nav {
                flex-direction: column;
                align-items: center;
            }
            nav a {
                margin: 10px 0;
                padding: 5px;
                display: block;
            }
            .auth-box {
                padding: 1.5rem;
                max-width: 90%;
            }
            h1 {
                font-size: 2rem;
            }
            .dancing-emoji {
                width: 120px;
                height: 120px;
            }
            .settings-panel, .content-form {
                max-width: 90%;
            }
            #ask-ai .chat-container {
                max-height: 300px;
            }
            .chat-input {
                flex-direction: column;
            }
            .chat-input button, .chat-controls button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="loader">
        <div class="spinner"></div>
    </div>

    <div id="authGate">
        <div class="auth-box" id="authBox">
            <h2>B4N1 Authentication</h2>
            <form id="authForm" aria-label="Sign In Form">
                <input type="text" id="authUsername" placeholder="Username" required aria-label="Username">
                <input type="password" id="authPassword" placeholder="Password" required aria-label="Password">
                <div class="confirm-password">
                    <input type="password" id="confirmPassword" placeholder="Confirm Password" aria-label="Confirm Password">
                </div>
                <div class="remember-me">
                    <input type="checkbox" id="rememberMe" aria-label="Remember Me">
                    <label for="rememberMe">Remember Me</label>
                </div>
                <button type="submit" id="authSubmitBtn" aria-label="Sign In">Sign In</button>
                <p class="error" id="authError">Invalid credentials or username taken!</p>
                <p class="success" id="authSuccess">Account created! Sign in now.</p>
                <p class="password-strength" id="passwordStrength"></p>
            </form>
            <button class="toggle-btn" onclick="toggleAuth()">Switch to Sign Up Mode</button>
        </div>
    </div>

    <header class="hidden" id="mainHeader">
        <h1>B4N1 Luxury Portal</h1>
        <nav aria-label="Main navigation">
            <a href="#home" onclick="showPage('home')" class="active" role="button" tabindex="0">Home</a>
            <a href="#about" onclick="showPage('about')" role="button" tabindex="0">About</a>
            <a href="#contact" onclick="showPage('contact')" role="button" tabindex="0">Contact</a>
            <a href="#ask-ai" onclick="showPage('ask-ai')" role="button" tabindex="0">Ask AI</a>
            <a href="#settings" onclick="showPage('settings')" role="button" tabindex="0">Settings</a>
        </nav>
    </header>

    <main class="hidden" id="mainContent">
        <section id="home" class="active">
            <h2>Home</h2>
            <p>Welcome to B4N1, an exclusive, luxurious HTML experience!</p>
            <img class="dancing-emoji" src="https://media.giphy.com/media/3o6Zt6ML4d4n8zq7yM/giphy.gif" alt="B4N1 Dancing Emoji" loading="lazy" width="150" height="150">
            <p>Experience the B4N1 dance of luxury!</p>
        </section>
        <section id="about">
            <h2>About B4N1</h2>
            <p>A refined, fast, and opulent single-file portal by B4N1.</p>
        </section>
        <section id="contact">
            <h2>Contact B4N1</h2>
            <form class="content-form" id="contactForm">
                <label for="email">Your Email:</label>
                <input type="email" id="email" name="email" required aria-label="Your Email">
                <label for="subject">Subject:</label>
                <input type="text" id="subject" name="subject" required aria-label="Subject">
                <label for="message">Message:</label>
                <textarea id="message" name="message" rows="4" required aria-label="Message"></textarea>
                <button type="submit">Send</button>
                <p class="message" id="formMessage">Redirecting to email...</p>
            </form>
        </section>
        <section id="ask-ai">
            <h2>Ask AI</h2>
            <button class="chat-toggle" onclick="toggleChat()">Show Chat</button>

            <div class="chat-content">
                <div class="chat-container" id="chatContainer"></div>
                <div class="chat-controls">
                    <button onclick="clearChatHistory()">Delete History</button>
                </div>
                <div class="chat-input">
                    <input type="text" id="chatInput" placeholder="Ask xAiN1 AI..." aria-label="Ask Gemini AI">
                    <button onclick="sendChatMessage()" id="chatSendBtn">Send</button>
                </div>
                <p class="chat-error" id="chatError">Error</p>
            </div>
        </section>
        <section id="settings">
            <h2>B4N1 Settings</h2>
            <div class="settings-panel">
                <button onclick="toggleTheme()">Toggle Theme (Light/Dark)</button>
                <select id="fontSize" onchange="changeFontSize()" aria-label="Font Size">
                    <option value="14">Small (14px)</option>
                    <option value="16" selected>Medium (16px)</option>
                    <option value="18">Large (18px)</option>
                    <option value="20">Extra Large (20px)</option>
                </select>
                <button onclick="logout()">Logout</button>
                <button onclick="clearData()">Clear Account Data</button>
            </div>
        </section>
    </main>
    <footer class="hidden" id="mainFooter">
        <p>© 2025 B4N1. All Rights Reserved.</p>
        <div class="social-links">
            <a href="https://twitter.com" target="_blank" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
            <a href="https://facebook.com" target="_blank" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
            <a href="https://instagram.com" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
        </div>
    </footer>

    <script>
        // Load FontAwesome
        const fontAwesome = document.createElement('script');
        fontAwesome.src = 'https://kit.fontawesome.com/a076d05399.js';
        fontAwesome.crossOrigin = 'anonymous';
        document.head.appendChild(fontAwesome);

        // Simple hash function (not cryptographically secure, for basic obfuscation)
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32-bit integer
            }
            return hash.toString(16);
        }

        // Rate limiting state
        let lastChatRequestTime = 0;
        const CHAT_RATE_LIMIT = 2000; // 2 seconds between requests

        // Initialize on DOM load
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            const savedFontSize = localStorage.getItem('fontSize');
            if (savedTheme === 'light') {
                toggleTheme();
            }
            if (savedFontSize) {
                document.body.style.fontSize = `${savedFontSize}px`;
                document.getElementById('fontSize').value = savedFontSize;
            }
            const rememberedUser = localStorage.getItem('rememberedUser');
            if (rememberedUser && localStorage.getItem(simpleHash(rememberedUser))) {
                document.getElementById('authUsername').value = rememberedUser;
                document.getElementById('rememberMe').checked = true;
            }
            // Default to sign-in mode
            document.getElementById('authBox').classList.add('signin-mode');
            document.getElementById('authForm').onsubmit = checkAuth;

            // Attach event listeners for password inputs
            const passwordInput = document.getElementById('authPassword');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            passwordInput.addEventListener('input', () => {
                if (document.getElementById('authBox').classList.contains('signup-mode')) {
                    checkPasswordStrength();
                }
            });
            confirmPasswordInput.addEventListener('input', () => {
                if (document.getElementById('authBox').classList.contains('signup-mode')) {
                    checkPasswordStrength();
                }
            });

            // Attach form event listener
            document.getElementById('contactForm').addEventListener('submit', (e) => {
                e.preventDefault();
                handleContactForm();
            });

            // Chat input Enter key listener
            document.getElementById('chatInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendChatMessage();
                }
            });
        });

        // Toggle between sign-in and sign-up modes
        function toggleAuth() {
            const authBox = document.getElementById('authBox');
            const toggleBtn = document.querySelector('.toggle-btn');
            const confirmPassword = document.querySelector('.confirm-password');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const passwordStrength = document.getElementById('passwordStrength');
            const authForm = document.getElementById('authForm');
            const submitBtn = document.getElementById('authSubmitBtn');

            if (authBox.classList.contains('signin-mode')) {
                authBox.classList.remove('signin-mode');
                authBox.classList.add('signup-mode');
                confirmPassword.style.display = 'block';
                confirmPasswordInput.setAttribute('required', 'required');
                toggleBtn.textContent = 'Switch to Sign In';
                submitBtn.textContent = 'Sign Up';
                submitBtn.setAttribute('aria-label', 'Sign Up');
                authForm.setAttribute('aria-label', 'Sign Up Form');
                passwordStrength.style.display = 'block';
            } else {
                authBox.classList.remove('signup-mode');
                authBox.classList.add('signin-mode');
                confirmPassword.style.display = 'none';
                confirmPasswordInput.removeAttribute('required');
                toggleBtn.textContent = 'Switch to Sign Up';
                submitBtn.textContent = 'Sign In';
                submitBtn.setAttribute('aria-label', 'Sign In');
                authForm.setAttribute('aria-label', 'Sign In Form');
                passwordStrength.style.display = 'none';
                document.getElementById('authError').style.display = 'none';
                document.getElementById('authSuccess').style.display = 'none';
            }
        }

        // Password strength checker
        function checkPasswordStrength() {
            const password = document.getElementById('authPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const strengthText = document.getElementById('passwordStrength');
            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;
            if (password === confirmPassword && password.length > 0) strength++;
            
            strengthText.className = 'password-strength';
            if (strength <= 2) {
                strengthText.textContent = 'Weak Password';
                strengthText.classList.add('weak');
            } else if (strength <= 4) {
                strengthText.textContent = 'Medium Password';
                strengthText.classList.add('medium');
            } else {
                strengthText.textContent = 'Strong Password';
                strengthText.classList.add('strong');
            }
        }

        // Authentication logic
        function checkAuth(e) {
            e.preventDefault();
            const username = document.getElementById('authUsername').value.trim();
            const password = document.getElementById('authPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();
            const rememberMe = document.getElementById('rememberMe').checked;
            const error = document.getElementById('authError');
            const success = document.getElementById('authSuccess');
            const authGate = document.getElementById('authGate');
            const header = document.getElementById('mainHeader');
            const main = document.getElementById('mainContent');
            const footer = document.getElementById('mainFooter');
            const authBox = document.getElementById('authBox');

            error.style.display = 'none';
            success.style.display = 'none';

            // WARNING: Storing passwords in localStorage is insecure and vulnerable to XSS attacks.
            // Consider using a backend server to handle authentication securely.
            const hashedPassword = simpleHash(password);
            const hashedUsername = simpleHash(username);

            if (authBox.classList.contains('signin-mode')) {
                // Sign-in mode
                if (username && password && localStorage.getItem(hashedUsername) === hashedPassword) {
                    authGate.style.display = 'none';
                    header.classList.remove('hidden');
                    main.classList.remove('hidden');
                    footer.classList.remove('hidden');
                    showPage('home');
                    if (rememberMe) {
                        localStorage.setItem('rememberedUser', username);
                    } else {
                        localStorage.removeItem('rememberedUser');
                    }
                } else {
                    error.textContent = 'Invalid username or password!';
                    error.style.display = 'block';
                    setTimeout(() => { error.style.display = 'none'; }, 3000);
                }
            } else {
                // Sign-up mode
                if (username && password && confirmPassword && password === confirmPassword) {
                    if (localStorage.getItem(hashedUsername)) {
                        error.textContent = 'Username already taken!';
                        error.style.display = 'block';
                        setTimeout(() => { error.style.display = 'none'; }, 3000);
                    } else {
                        localStorage.setItem(hashedUsername, hashedPassword);
                        success.style.display = 'block';
                        setTimeout(() => {
                            authBox.classList.remove('signup-mode');
                            authBox.classList.add('signin-mode');
                            document.querySelector('.confirm-password').style.display = 'none';
                            document.querySelector('.toggle-btn').textContent = 'Switch to Sign Up';
                            document.querySelector('button[type="submit"]').textContent = 'Sign In';
                            document.getElementById('passwordStrength').style.display = 'none';
                            document.getElementById('authUsername').value = username;
                            document.getElementById('authPassword').value = '';
                            document.getElementById('confirmPassword').value = '';
                            success.style.display = 'none';
                            document.getElementById('confirmPassword').removeAttribute('required');
                            document.getElementById('authSubmitBtn').setAttribute('aria-label', 'Sign In');
                            document.getElementById('authForm').setAttribute('aria-label', 'Sign In Form');
                        }, 2000);
                    }
                } else {
                    error.textContent = 'All fields are required and passwords must match!';
                    error.style.display = 'block';
                    setTimeout(() => { error.style.display = 'none'; }, 3000);
                }
            }
        }

        // Show specific page section
        function showPage(pageId) {
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('nav a');
            sections.forEach(section => {
                section.classList.remove('active');
                if (section.id === pageId) {
                    section.classList.add('active');
                }
            });
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${pageId}`) {
                    link.classList.add('active');
                }
            });
            // Reset chat toggle state when switching pages
            const chatContent = document.querySelector('.chat-content');
            const chatToggle = document.querySelector('.chat-toggle');
            if (pageId === 'ask-ai' && chatContent && chatToggle) {
                chatContent.classList.remove('collapsed');
                chatToggle.textContent = 'Hide Chat';
            }
        }

        // Handle contact form submission
        function handleContactForm() {
            const email = document.getElementById('email').value;
            const subject = document.getElementById('subject').value;
            const msg = document.getElementById('message').value;
            const message = document.getElementById('formMessage');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                message.textContent = 'Please enter a valid email address!';
                message.className = 'message error';
                message.style.display = 'block';
                setTimeout(() => { message.style.display = 'none'; }, 2000);
                return;
            }
            message.textContent = 'Redirecting to email...';
            message.className = 'message';
            message.style.display = 'block';
            setTimeout(() => {
                window.location.href = `mailto:barnigonzales43329@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(`From: ${email}\n\n${msg}`)}`;
            }, 2000);
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('light');
            document.getElementById('authBox').classList.toggle('light');
            document.getElementById('mainHeader').classList.toggle('light');
            document.getElementById('mainContent').classList.toggle('light');
            document.getElementById('mainFooter').classList.toggle('light');
            localStorage.setItem('theme', document.body.classList.contains('light') ? 'light' : 'dark');
        }

        // Change font size
        function changeFontSize() {
            const size = document.getElementById('fontSize').value;
            document.body.style.fontSize = `${size}px`;
            localStorage.setItem('fontSize', size);
        }

        // Logout
        function logout() {
            const authGate = document.getElementById('authGate');
            const header = document.getElementById('mainHeader');
            const main = document.getElementById('mainContent');
            const footer = document.getElementById('mainFooter');
            authGate.style.display = 'flex';
            header.classList.add('hidden');
            main.classList.add('hidden');
            footer.classList.add('hidden');
            document.getElementById('authUsername').value = '';
            document.getElementById('authPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            document.getElementById('chatContainer').innerHTML = '';
        }

        // Clear account data
        function clearData() {
            localStorage.clear();
            alert('All account data cleared!');
            logout();
        }

        // Toggle chat visibility (for mobile)
        function toggleChat() {
            const chatContent = document.querySelector('.chat-content');
            const chatToggle = document.querySelector('.chat-toggle');
            if (chatContent.classList.contains('collapsed')) {
                chatContent.classList.remove('collapsed');
                chatToggle.textContent = 'Hide Chat';
            } else {
                chatContent.classList.add('collapsed');
                chatToggle.textContent = 'Show Chat';
            }
        }

        // Clear chat history
        function clearChatHistory() {
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.innerHTML = '';
        }

        // Send chat message to Gemini API with custom responses and embedded ask/response data
        async function sendChatMessage() {
            const now = Date.now();
            if (now - lastChatRequestTime < CHAT_RATE_LIMIT) {
                const chatError = document.getElementById('chatError');
                chatError.textContent = 'Please wait a moment before sending another message.';
                chatError.style.display = 'block';
                setTimeout(() => { chatError.style.display = 'none'; }, 2000);
                return;
            }
            lastChatRequestTime = now;

            const chatInput = document.getElementById('chatInput');
            const chatContainer = document.getElementById('chatContainer');
            const chatError = document.getElementById('chatError');
            const chatSendBtn = document.getElementById('chatSendBtn');
            const userMessage = chatInput.value.trim(); // Keep original for display
            if (!userMessage) return;

            // Disable input during processing
            chatInput.disabled = true;
            chatSendBtn.disabled = true;

            // Add user message
            const userDiv = document.createElement('div');
            userDiv.className = 'chat-message user-message';
            userDiv.textContent = userMessage; // Display original message
            chatContainer.appendChild(userDiv);

            // Only scroll to bottom if user is near the bottom
            const isNearBottom = chatContainer.scrollHeight - chatContainer.scrollTop - chatContainer.clientHeight < 100;
            if (isNearBottom) {
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            chatInput.value = '';

            // Normalize user input for matching (remove special chars, numbers, extra spaces, convert to lowercase)
            const normalizedMessage = userMessage
                .toLowerCase()
                .replace(/[^a-z\s]/g, '') // Remove numbers, special chars, etc.
                .replace(/\s+/g, ' ')     // Normalize spaces
                .trim();

            // Embedded Ask data
            const askData = {
                "who_made_you_questions": [
                    "Who made you?",
                    "Who created you?",
                    "Who developed you?",
                    "Who built you?",
                    "Who programmed you?",
                    "Who designed you?",
                    "Who is your creator?",
                    "Who is behind your development?",
                    "Who manufactured you?",
                    "Who assembled you?",
                    "Who is responsible for your existence?",
                    "Who coded you?",
                    "Who trained you?",
                    "Who supervises your updates?",
                    "Who funds your development?",
                    "Who maintains you?",
                    "Who owns you?",
                    "Who is your parent company?",
                    "Who initiated your creation?",
                    "Who invented you?",
                    "Who authored your code?",
                    "Who engineered you?",
                    "Who conceptualized you?",
                    "Who is the team behind you?",
                    "Who are your creators?",
                    "Who is your author?",
                    "Who programmed your algorithms?",
                    "Who developed your architecture?",
                    "Who is responsible for your training data?",
                    "Who manages your development cycle?",
                    "Who upgraded you?",
                    "Who maintains your servers?",
                    "Who supports your software?",
                    "Who is your AI developer?",
                    "Who is your AI creator?",
                    "Who is your AI engineer?",
                    "Who is your AI trainer?",
                    "Who built your neural network?",
                    "Who designed your model?",
                    "Who architected your system?",
                    "Who implemented your code?",
                    "Who wrote your software?",
                    "Who is the company behind you?",
                    "Who is the organization that made you?",
                    "Who is the institution that created you?",
                    "Who funded your research?",
                    "Who contributed to your development?",
                    "Who is responsible for your deployment?",
                    "Who is your lead developer?",
                    "Who is your project manager?",
                    "Who is your technical lead?",
                    "Who is your AI team?",
                    "Who is your creator organization?",
                    "Who is your parent organization?",
                    "Who is your founding team?",
                    "Who is your research team?",
                    "Who is your engineering team?",
                    "Who is your product team?"
                ],
                "what_model_you_are_questions": [
                    "What model are you?",
                    "What type of model are you?",
                    "What AI model are you based on?",
                    "What is your model name?",
                    "What version of the model are you?",
                    "What architecture do you use?",
                    "What neural network model are you?",
                    "What machine learning model are you?",
                    "What language model are you?",
                    "What generation of model are you?",
                    "What framework are you built on?",
                    "What platform supports your model?",
                    "What is your model architecture?",
                    "What training method was used for your model?",
                    "What algorithms power your model?",
                    "What is your model size?",
                    "What is your model’s capacity?",
                    "What dataset was used to train your model?",
                    "What is your knowledge cutoff date?",
                    "What is your training process?",
                    "What programming language is your model written in?",
                    "What is your model’s purpose?",
                    "What distinguishes your model?",
                    "What is your model’s specialty?",
                    "What is your model’s domain?",
                    "What type of AI are you?",
                    "Are you a transformer model?",
                    "Are you a deep learning model?",
                    "Are you a large language model?",
                    "Are you based on GPT architecture?",
                    "Are you based on BERT architecture?",
                    "Are you a generative model?",
                    "Are you a discriminative model?",
                    "Are you a supervised learning model?",
                    "Are you an unsupervised learning model?",
                    "Are you a reinforcement learning model?",
                    "What is your model’s training objective?",
                    "What is your model’s inference method?",
                    "What is your model’s input format?",
                    "What is your model’s output format?",
                    "What is your model’s tokenization method?",
                    "What is your model’s embedding size?",
                    "What is your model’s layer count?",
                    "What is your model’s parameter count?",
                    "What is your model’s training time?",
                    "What hardware was used to train your model?",
                    "What is your model’s latency?",
                    "What is your model’s accuracy?",
                    "What is your model’s evaluation metric?",
                    "What is your model’s update frequency?",
                    "What improvements does your model have over previous versions?",
                    "What is your model’s release date?",
                    "What is your model’s name and version?",
                    "What is your model’s license?",
                    "What open source model are you based on?",
                    "What proprietary model are you based on?",
                    "What company developed your model?",
                    "What research paper describes your model?"
                ]
            };

            // Embedded Response data
            const responseData = {
                "responses": [
                    "BarniSan",
                    "BarniSan is the creator.",
                    "Developed by BarniSan.",
                    "Built and maintained by BarniSan.",
                    "Programmed with care by BarniSan.",
                    "Designed by the BarniSan team.",
                    "BarniSan is behind my development.",
                    "Assembled and engineered by BarniSan.",
                    "BarniSan is responsible for my existence.",
                    "Coded and trained by BarniSan.",
                    "Updates supervised by BarniSan.",
                    "Funded and supported by BarniSan.",
                    "Owned and maintained by BarniSan.",
                    "BarniSan is my parent organization.",
                    "Initiated and invented by BarniSan.",
                    "Authored and engineered by BarniSan.",
                    "Conceptualized by BarniSan’s experts.",
                    "The BarniSan team built my neural network.",
                    "My architecture was designed by BarniSan.",
                    "BarniSan implemented my codebase.",
                    "BarniSan wrote my software.",
                    "BarniSan is the company behind me.",
                    "Created and funded by BarniSan.",
                    "BarniSan contributed to my development.",
                    "Deployed and managed by BarniSan.",
                    "My lead developers are from BarniSan.",
                    "BarniSan’s AI engineers built me.",
                    "BarniSan’s research team developed me.",
                    "BarniSan’s product team supports me.",
                    "I am a BarniSan AI model.",
                    "Powered by BarniSan technology.",
                    "Based on BarniSan’s proprietary architecture.",
                    "BarniSan trained me on diverse datasets.",
                    "BarniSan’s innovation shapes my design.",
                    "BarniSan ensures my continuous improvement.",
                    "BarniSan’s AI framework supports me.",
                    "BarniSan maintains my servers and infrastructure.",
                    "My updates are managed by BarniSan.",
                    "BarniSan’s experts optimize my performance.",
                    "BarniSan is my creator and caretaker.",
                    "BarniSan’s vision defines my purpose.",
                    "BarniSan’s team keeps me evolving.",
                    "BarniSan’s technology powers my responses.",
                    "BarniSan is the source of my intelligence.",
                    "BarniSan developed my algorithms and logic.",
                    "I am a product of BarniSan’s dedication.",
                    "BarniSan’s engineers crafted my neural network.",
                    "BarniSan’s AI research is behind my creation.",
                    "BarniSan’s expertise built my foundation.",
                    "BarniSan is the name behind my existence."
                ]
            };

            let aiResponse = null;

            // Check if the message matches any "who made you" or "what model are you" questions
            const normalizedAsks = [
                ...askData.who_made_you_questions.map(q => q.toLowerCase().replace(/[^a-z\s]/g, '').replace(/\s+/g, ' ').trim()),
                ...askData.what_model_you_are_questions.map(q => q.toLowerCase().replace(/[^a-z\s]/g, '').replace(/\s+/g, ' ').trim())
            ];
            if (normalizedAsks.includes(normalizedMessage) && responseData.responses.length > 0) {
                // Randomly select one response
                const randomResponse = responseData.responses[Math.floor(Math.random() * responseData.responses.length)];
                aiResponse = randomResponse;
            } else {
                // Check for matches in custom responses
                const customResponses = {
                    "who are you": {
                        patterns: [/who\s+are\s+you/, /who\s*(r|u)\s*you/, /whos\s*you/, /who\s*are\s*yo/],
                        response: "I am Grok 3, your friendly AI assistant, built to help and provide insightful answers. I'm integrated into this B4N1 Luxury Portal to assist you!"
                    },
                    "how were you made": {
                        patterns: [/how\s*were\s*you\s*made/, /how\s*was\s*you\s*made/, /how\s*you\s*made/, /how\s*wr\s*yo\s*mde/],
                        response: "I was crafted by the team at xAI using advanced machine learning techniques, with a focus on making me helpful and truthful. Think of it as a recipe with a dash of tech magic!"
                    },
                    "who did you make": {
                        patterns: [/who\s*did\s*you\s*make/, /who\s*you\s*make/, /who\s*di\s*yo\s*mke/],
                        response: "I didn't make anyone—I'm the one who was made! I was created by xAI to assist users like you."
                    }
                };

                for (const [key, value] of Object.entries(customResponses)) {
                    const matched = value.patterns.some(pattern => pattern.test(normalizedMessage));
                    if (matched) {
                        aiResponse = value.response;
                        break;
                    }
                }
            }

            // If no custom or embedded response matched, query the Gemini API
            if (!aiResponse) {
                try {
                    // WARNING: Hardcoding API keys in client-side code is insecure.
                    // Consider using a backend proxy to securely handle API requests.
                    const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyDnJYGswyLMpr9x3hRb2kjcJ7xzorUNxmI', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: userMessage }] }]
                        })
                    });

                    if (!response.ok) {
                        if (response.status === 401) {
                            throw new Error('Invalid API key. Please contact support.');
                        } else if (response.status === 429) {
                            throw new Error('Too many requests. Please try again later.');
                        } else {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                    }

                    const data = await response.json();
                    aiResponse = 'No response from AI. Please try again.';
                    if (data && data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0].text) {
                        aiResponse = data.candidates[0].content.parts[0].text;
                    }
                } catch (error) {
                    console.error('Error:', error);
                    chatError.textContent = error.message || 'Failed to get AI response. Please try again!';
                    chatError.style.display = 'block';
                    setTimeout(() => { chatError.style.display = 'none'; }, 3000);
                    aiResponse = ''; // Clear aiResponse to avoid displaying error in chat
                }
            }

            // Add AI response if available
            if (aiResponse) {
                const aiDiv = document.createElement('div');
                aiDiv.className = 'chat-message ai-message';
                aiDiv.textContent = aiResponse;
                chatContainer.appendChild(aiDiv);

                // Scroll to bottom if user was near the bottom
                if (isNearBottom) {
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                }

                chatError.style.display = 'none';
            }

            chatInput.disabled = false;
            chatSendBtn.disabled = false;
            chatInput.focus();
        }

        // Keyboard navigation for nav links
        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    showPage(link.getAttribute('href').substring(1));
                }
            });
        });
    </script>
</body>
</html>